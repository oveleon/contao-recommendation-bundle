<h1 align="center">Contao Recommendation Bundle</h1>
<p align="center"><i>The contao recommendation bundle adds recommendations to Contao 4.</i></p>
<p align="center">
    <a href="https://www.oveleon.de"><img src="https://img.shields.io/badge/oveleon-maintained-83aa0e?style=flat-square&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAUCAYAAABvVQZ0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA/xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ1dWlkOjVEMjA4OTI0OTNCRkRCMTE5MTRBODU5MEQzMTUwOEM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM5MjZBNjQzMzZFQjExRUFBMTdBQkNFQTAxNjg2RDI4IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM5MjZBNjQyMzZFQjExRUFBMTdBQkNFQTAxNjg2RDI4IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIElsbHVzdHJhdG9yIENTNiAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0idXVpZDplMDhkZDhmZC1mOTA4LTQ5YzItYWMwZC00OGE3YTI4ODc2YWEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTA2RDhGOENERUQxRTgxMTgyMjVBMzBGQ0NBNjE4RUQiLz4gPGRjOnRpdGxlPiA8cmRmOkFsdD4gPHJkZjpsaSB4bWw6bGFuZz0ieC1kZWZhdWx0Ij5Mb2dvX292ZWxlb25fWmVpY2hlbl9yejwvcmRmOmxpPiA8L3JkZjpBbHQ+IDwvZGM6dGl0bGU+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+P8iBTQAAAbFJREFUeNqU08srRFEcB/BromGGaJRHKSIaYfIm7JRSsvHIyuM/wMorNeEfUMqKnbKwU2TBwpSUSWYWFmSBDKWmWcgwcX2Pvrc5HXfuXL/6zD2P3z2Puedouq5rilG40JPxAuUmeX84tGTkwyXsghOWYQmKoFazExzVDXFIgEeazcPV9TCnzGplRiHMl7KgCWYghy9vQAasMEfkTqQarJ9JFWw0YlhJFv2rUv8tdKiDhTib0eiHQyhOsR2xyjlp0BF5MBELdr6WohE++X6raBOz6PwWCfiCOLzDN8sRGICYyfdrgBA8Q2kmfnzQJirghlw+XZANUQ5qFmHY52R9/9lWCXjBpbRPcaubDhtHsRoOuN1reAO/1H/PpzfdaqrggzOLK7YFD6zPMqeL9at0gwWZuKa0i3hkuZf1E6tteqEZnmCRbZVwxPIOn3V83litaogzbrPuhDOIwbyUd8q8SavBOpl0rnxROadFugkFVoOJAx1h4rRJvw9e2b9u3ACrY9ENAZaD/L/E0aiHMbbfQc3v7bFxWAchqptHAAqN3HQrM0JcsXFohzzexWPYk5N+BBgAix5VyvzRZbwAAAAASUVORK5CYII=" alt="Oveleon"></a>
    <a href="https://github.com/oveleon/contao-recommendation-bundle"><img src="https://img.shields.io/badge/license-MIT-83aa0e?style=flat-square"/></a>
    <a href="https://packagist.org/packages/oveleon/contao-recommendation-bundle"><img src="https://img.shields.io/packagist/dt/oveleon/contao-recommendation-bundle?color=0A7BBC&style=flat-square"/></a>
</p>
<br/>

---

> Working with **Contao 4.9** and up to **Contao 4.12** (PHP ^7.4 and PHP 8)

---

This plugin adds a new sub-menu *Recommendations* with recommendation archives and recommendations

+ [Features](#features)
+ [Installation](#installation)
  + [Composer](#via-composer)
  + [Contao Manager](#via-contao-manager)
+ [Initial setup](#initial-setup)
+ [Front end modules](#front-end-modules)
  + [Recommendation list](#recommendation-list)
  + [Recommendation reader](#recommendation-reader)
  + [Recommendation form](#recommendation-form)
+ [Sitemap](#sitemap)
+ [Verified recommendations / GDPR](#verified-recommendations--gdpr)
+ [Styled Reviews](#example)

## Features

- Compatible with Contao 4.9 and higher versions (PHP 8 Support)
- Possibility to create multiple recommendation archives
- Possibility to create recommendation items
- Frontend- and Backend permissions for archives and items
- Access protection for modules
- Recommendation list to display recommendation items
  - Choose multiple archives to display from
  - Filter by rating
  - Pagination
  - Featured recommendations (for sorting)
  - and more
- Recommendation reader for recommendations
- Recommendation form to let users submit their recommendations into a specific archive
  - Choose what users can submit
  - Get E-Mail notifications when people submit a recommendation
  - Moderation settings
  - Possibility to add a privacy checkbox
  - Possibility to activate an e-mail verification (opt-in) to verify recommendations
- No IP-logging
- Sitemap-Integration
  - Recommendations will be added to the sitemap.xml
- Automatic purge of non verified recommendations
- Cache invalidation

## Installation

#### Via composer
```
composer require oveleon/contao-recommendation-bundle
```

#### Via contao-manager
```
Search for contao recommendation bundle and add it to your extensions.
```


After installing the contao-recommendation-bundle, you need to run a **contao install**.

## Initial setup

The recommendation bundle is close to the core-bundles of contao cms. 
If you are familiar using the news- or events bundle, you should be able to set it up without further knowledge.

1. Create a new archive in *Recommendations*

   ![Admin View: Recommendation Archive](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/recommendationArchive.jpg)


2. Create a new recommendation in your archive and fill out
   - Author
   - Date and time are set automatically but can be changed
   - Recommendation text
   - Choose a Rating (1 to 5)
   - Publish the recommendation
   
    ![Admin View: Recommendation](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/recommendation.jpg)


3. To display your recommendations, you will need a recommendation-list.
   1. Create the front end module *recommendation-list*
   2. Choose your recommendation archive/s
   3. Choose the meta fields you want to show in your front end
   4. Embed the module in a page

   ![Admin View: Recommendation List](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/recommendationList.jpg)


4. Setting up colors for your recommendation rating
   - You can go to "settings" within *Recommendations* (Location of archives) and choose a color for active stars

   ![Admin View: Recommendation Archive Settings](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/recommendationArchiveSettings.jpg)


5. Setting up a recommendation-reader for a redirect page
   1. Create the front end module *recommendation-reader*
   2. Choose your recommendation archive/s
   3. Choose the meta fields you want to show in your front end
   4. Embed the module in a page or set it up for your recommendation-list
   5. Set up the redirect page in your recommendation archive/s

   ![Admin View: Recommendation Reader](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/recommendationReader.jpg)


Recommendation List on your website
![Admin View: Recommendation Frontend](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/frontendList.jpg)
## Front end modules

### Recommendation list
The recommendation list can display published (and verified) recommendations from selected archives.

#### Settings
<table>
  <tr>
    <th colspan="2"><strong>Recommendation-List</strong></th>
  </tr>
  <tr>
    <td><strong>Option</strong></td>
    <td><strong>Description</strong></td>
  </tr>
  <tr>
    <td>Recommendation archives</td>
    <td>Here you can select one or more archives to display recommendations from</td>
  </tr>
  <tr>
    <td>Recommendation reader module</td>
    <td>Automatically switches to the recommendation reader if a recommendation has been selected</td>
  </tr>
  <tr>
    <td>Minimum rating</td>
    <td>Filter displayed recommendations based on their rating (e.g. minimum of 3 stars)</td>
  </tr>
  <tr>
    <td>Featured items</td>
    <td>Here you can choose how featured recommendations are handled</td>
  </tr>
  <tr>
    <td>Sort order</td>
    <td>Here you can choose the sort order of recommendations (e.g. by date, rating, random)</td>
  </tr>
  <tr>
    <td>Number of items</td>
    <td>Here you can limit the total number of recommendations that are shown</td>
  </tr>
  <tr>
    <td>Items per page</td>
    <td>Number of recommendations per page - Activates pagination</td>
  </tr>
  <tr>
    <td>Meta fields</td>
    <td>Here you can select meta fields to display</td>
  </tr>
  <tr>
    <td>Recommendation template</td>
    <td>The recommendation template that is being used</td>
  </tr>
  <tr>
    <td>Module template</td>
    <td>The modules template that is being used</td>
  </tr>
  <tr>
    <td>Image settings</td>
    <td>You have the possibility to add pictures to your recommendations. These are the image settings for them</td>
  </tr>
  <tr>
    <td>Access protection</td>
    <td>Show the module for certain member groups only</td>
  </tr>
</table>

---

### Recommendation reader
The recommendation list can display published (and verified) recommendations from selected archives.

#### Settings
<table>
  <tr>
    <th colspan="2"><strong>Recommendation-Reader</strong></th>
  </tr>
  <tr>
    <td><strong>Option</strong></td>
    <td><strong>Description</strong></td>
  </tr>
  <tr>
    <td>Recommendation archives</td>
    <td>Here you can select one or more archives to read recommendations from</td>
  </tr>
  <tr>
    <td>Meta fields</td>
    <td>Here you can select meta fields to display</td>
  </tr>
  <tr>
    <td>Recommendation template</td>
    <td>The recommendation template that is being used</td>
  </tr>
  <tr>
    <td>Module template</td>
    <td>The modules template that is being used</td>
  </tr>
  <tr>
    <td>Image settings</td>
    <td>You have the possibility to add pictures to your recommendations. These are the image settings for them</td>
  </tr>
  <tr>
    <td>Access protection</td>
    <td>Show the module for certain member groups only</td>
  </tr>
</table>

---


### Recommendation form
The recommendation form can be used to let your visitors submit recommendations on your website. These recommendations will be saved in a preconfigured archive.

#### Settings
<table>
  <tr>
    <th colspan="2"><strong>Recommendation-Form</strong></th>
  </tr>
  <tr>
    <td><strong>Option</strong></td>
    <td><strong>Description</strong></td>
  </tr>
  <tr>
    <td>Recommendation archive</td>
    <td>Here you can select the archive that will save the submitted recommendations</td>
  </tr>
  <tr>
    <td>Optional recommendation fields</td>
    <td>Here you can select one or more fields that will be added to the form. Author, rating and text are always mandatory.</td>
  </tr>
  <tr>
    <td>E-Mail notifications</td>
    <td>Enable notifying the administrator when a recommendation has been submitted</td>
  </tr>
  <tr>
    <td>Moderate</td>
    <td>If true, recommendations need to be published before appearing on the website.</td>
  </tr>
  <tr>
    <td>Disable spam protection</td>
    <td>Disables the spam protection for the recommendation form</td>
  </tr>
  <tr>
    <td>Data security</td>
    <td>Here you can add a label for a checkbox to make the recommendation form GDPR compliant. A checkbox will appear if you add any text.</td>
  </tr>
  <tr>
    <td>Redirect page</td>
    <td>A redirect page to which visitors will be redirected after submitting the form</td>
  </tr>
  <tr>
    <td>Send activation e-mail</td>
    <td>Enable e-mail opt-in verification for verifying submitted recommendations</td>
  </tr>
  <tr>
    <td>Confirmation page</td>
    <td>A redirect page to which visitors will be redirected after clicking on the confirmation link</td>
  </tr>
  <tr>
    <td>Activation message</td>
    <td>The activation message that users receive after submitting a form</td>
  </tr>
  <tr>
    <td>Module template</td>
    <td>The modules template that is being used</td>
  </tr>
  <tr>
    <td>Access protection</td>
    <td>Show the module for certain member groups only</td>
  </tr>
</table>


## Sitemap

Recommendation archives that are not protected and have a jumpTo page will add their published recommendations to your sitemap.xml.
It is recommended to have a title for your recommendations as they are being used to create an alias.
If you do not want certain recommendations to be shown on your sitemap, you can unpublish them.


## Verified recommendations / GDPR

When adding a privacy text to the recommendation form, it will create a mandatory checkbox that visitors have to accept to submit their forms.

Recommendations that are created in the backend are verified by default. 
You have the possibility to set up an activation mail in recommendation forms that will be sent to the visitor. 
The submitted recommendations will not be shown on any list and can not be verified by the administrator.
A cronjob will purge the unverified recommendations after 24 hours.

![Admin View: Unverified Recommendations](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/unverifiedRecommendations.jpg)

The recommendation form does not save the IP of the user. However, it will save the e-mail-address of a user if they verified their recommendation
with the opt-in token.

## Example

An example how to style your reviews on your website

![Admin View: Recommendation Exammple](https://www.oveleon.de/share/github-assets/contao-recommendation-bundle/recommendationExample.png)
